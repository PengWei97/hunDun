在有限元方法中，**变分原理**被用来将偏微分方程的**强形式**转化为**弱形式**。下面以**线性弹性问题**为例，讲解如何基于变分原理从强形式推导出弱形式。

### **线性弹性问题的强形式**

假设我们有一个一维的线性弹性问题，目标是求解一个弹性体在外力作用下的位移场。弹性体的行为由以下的**强形式**方程描述：

\[
\sigma'(x) = f(x), \quad x \in (0, L)
\]

其中：
- \( \sigma(x) \) 是位移 \( u(x) \) 相关的应力（内力密度），满足霍克定律：\( \sigma(x) = E u'(x) \)，其中 \( E \) 是杨氏模量，\( u(x) \) 是位移场，\( u'(x) \) 是位移的导数。
- \( f(x) \) 是外部体力（例如重力或均匀载荷）作用下的密度。

边界条件为：
- **位移边界条件**： \( u(0) = 0 \) （固定端）。
- **力边界条件**： \( \sigma(L) = t_0 \) （在 \( x=L \) 位置施加外力，\( t_0 \) 为力密度）。

### **从强形式到弱形式的转化**

#### **1. 引入变分原理**

为了从强形式推导弱形式，首先需要构造一个合适的**能量泛函**。在弹性问题中，总的**势能泛函**（即弹性势能）是**应变能**，并且它由下面的公式给出：

\[
J[u] = \int_0^L \frac{E}{2} (u'(x))^2 \, dx
\]

这个泛函表示的是在外力作用下，物体发生变形时的弹性势能。

#### **2. 对泛函求变分**

为了求解最优解，我们需要对泛函进行变分。变分要求我们找出使得势能泛函 \( J[u] \) 最小化的位移 \( u(x) \)。为此，我们对泛函进行变分（即对位移函数 \( u(x) \) 做小的变化）。

首先，对泛函求变分，得到：

\[
\delta J[u] = \int_0^L E u'(x) \delta u'(x) \, dx
\]

使用分部积分（Integration by Parts）将 \( \delta u'(x) \) 移到边界：

\[
\delta J[u] = \left[ E u'(x) \delta u(x) \right]_0^L - \int_0^L E u''(x) \delta u(x) \, dx
\]

在边界上，\( \delta u(0) = 0 \) （位移固定），因此第一项的边界贡献为零。剩下的就是第二项：

\[
\delta J[u] = - \int_0^L E u''(x) \delta u(x) \, dx
\]

#### **3. 弱形式的推导**

为了使泛函极小化，要求变分为零：

\[
\delta J[u] = 0
\]

这意味着，对于任意的小变化 \( \delta u(x) \)，积分中的每一项都必须为零。因此，我们得到弱形式的方程：

\[
\int_0^L E u''(x) \delta u(x) \, dx = 0
\]

这就是弹性问题的弱形式，它表示的是系统在变形过程中，位移场 \( u(x) \) 的导数 \( u'(x) \) 满足一定的积分关系。

#### **4. 结合边界条件**

根据边界条件：
- 在 \( x=0 \)，\( u(0) = 0 \)。
- 在 \( x=L \)，施加外力边界条件 \( \sigma(L) = t_0 \)，根据应力-位移关系 \( \sigma = E u' \)，得到 \( E u'(L) = t_0 \)，即 \( u'(L) = t_0 / E \)。

这些边界条件会在弱形式求解过程中作为约束条件加进去。

### **总结**

通过变分原理，我们将线性弹性问题的强形式偏微分方程

\[
\sigma'(x) = f(x)
\]

转化为弱形式

\[
\int_0^L E u''(x) \delta u(x) \, dx = 0
\]

在弱形式中，**弱化**了对导数的要求，这样就不再要求试探函数 \( u(x) \) 在整个区间内是二阶可导的。这使得我们能够采用有限元方法进行离散化求解，因为有限元方法只要求试探函数在元素内部是足够光滑的，而不必满足强形式中的严格条件。

弱形式的引入，使得我们可以使用有限元方法通过逐步逼近的方式来求解实际工程中的弹性问题。